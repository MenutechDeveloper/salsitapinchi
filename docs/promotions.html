<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
   <script>
  window.restaurantId = 'bufalo';
</script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>restaurantapp</title>
    <link rel="icon" type="image/png" sizes="192x192" href="./assets/img/Dise침o%20sin%20t칤tulo%20(8).png">
    <link rel="icon" type="image/png" sizes="192x192" href="./assets/img/Dise침o%20sin%20t칤tulo%20(8).png" media="(prefers-color-scheme: dark)">
    <link rel="icon" type="image/png" sizes="192x192" href="./assets/img/Dise침o%20sin%20t칤tulo%20(8).png">
    <link rel="icon" type="image/png" sizes="192x192" href="./assets/img/Dise침o%20sin%20t칤tulo%20(8).png" media="(prefers-color-scheme: dark)">
    <link rel="icon" type="image/png" sizes="192x192" href="./assets/img/Dise침o%20sin%20t칤tulo%20(8).png">
    <link rel="icon" type="image/png" sizes="192x192" href="./assets/img/Dise침o%20sin%20t칤tulo%20(8).png">
    <link rel="icon" type="image/png" sizes="500x500" href="./assets/img/mks%20(9).png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
    <link rel="manifest" href="./manifest.json" crossorigin="use-credentials">
    <link rel="stylesheet" href="./assets/css/app.css">
   
<script src="./instalarapp.js" defer></script>
</head>

<body class="no-scroll"><div class="app">
<div class="rasca-container">
<div class="rasca">





<!-- CUP칍N -->
<div class="scratch-card">
  <img id="premio-img" src="https://lasalsitapinchi.com/img/premio.png" alt="Premio">
  <canvas id="scratch-canvas" width="300" height="300"></canvas>
</div>

<!-- MENSAJE -->
<div class="message-container" id="message-box">
  <p>游닞 Toma una captura del cup칩n y m치ndanos mensaje para reclamar tu premio.</p>
  <a href="https://m.me/TU_USUARIO_DE_MESSENGER" target="_blank">Enviar mensaje</a>
</div>

<script>
  const canvas = document.getElementById('scratch-canvas');
  const ctx = canvas.getContext('2d');
  const w = canvas.width;
  const h = canvas.height;

  const messageBox = document.getElementById('message-box');

  let hasTriggeredPulse = false;
  let hasShownMessage = false;
  let isDrawing = false;

  const coverImage = new Image();
  coverImage.crossOrigin = "anonymous"; // necesario para im치genes de otros dominios
  coverImage.src = 'https://lasalsitapinchi.com/img/rasca.png';

  coverImage.onload = () => {
    // Asegurarse de que se dibuja sobre todo el canvas
    ctx.globalCompositeOperation = 'source-over';
    ctx.drawImage(coverImage, 0, 0, w, h);
    ctx.globalCompositeOperation = 'destination-out'; // para raspar
  };

  function getPointerPos(e) {
    const rect = canvas.getBoundingClientRect();
    const x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
    const y = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
    return { x, y };
  }

  function draw(e) {
    if (!isDrawing) return;
    const { x, y } = getPointerPos(e);
    ctx.beginPath();
    ctx.arc(x, y, 20, 0, Math.PI * 2);
    ctx.fill();
    checkScratchPercent();
  }

  function checkScratchPercent() {
    const imageData = ctx.getImageData(0, 0, w, h);
    const total = imageData.data.length / 4;
    let transparent = 0;

    for (let i = 0; i < imageData.data.length; i += 4) {
      if (imageData.data[i + 3] === 0) {
        transparent++;
      }
    }

    const percent = transparent / total;

    if (percent > 0.7 && !hasTriggeredPulse) {
      document.getElementById('premio-img').classList.add('pulse');

      hasTriggeredPulse = true;
    }

    if (percent > 0.7 && !hasShownMessage) {
      messageBox.classList.add('show');
      hasShownMessage = true;
    }
  }

  function startDraw(e) {
    isDrawing = true;
    draw(e);
  }

  function endDraw() {
    isDrawing = false;
  }

  canvas.addEventListener('mousedown', startDraw);
  canvas.addEventListener('mousemove', draw);
  document.addEventListener('mouseup', endDraw);

  canvas.addEventListener('touchstart', startDraw, { passive: false });
  canvas.addEventListener('touchmove', (e) => {
    e.preventDefault();
    draw(e);
  }, { passive: false });
  document.addEventListener('touchend', endDraw);
</script>



</div></div>



    

    <div class="bottom-bar">
  <a href="https://lasalsitapinchi.com/" class="bar-icon logo-icon">
    <img src="https://lasalsitapinchi.com/logo.jpg" alt="Logo">
  </a>
  <a href="javascript:history.back()" class="bar-icon">
    <img src="https://menutechdeveloper.github.io/bddImg/assets/iconos/back.png" alt="Back">
  </a>
</div>
    <script src="./assets/js/portapapeles.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./assets/js/filtro.js"></script>
    
    <script src="./assets/js/spash.js"></script>
       <script src="./script.js"></script>
        <script src="./assets/js/seguridad.js"></script>
</div>

</body>


</html>
